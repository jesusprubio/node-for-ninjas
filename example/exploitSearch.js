#!/usr/bin/env node

/*
  Copyright Jesús Pérez <jesusprubio@gmail.com>

  This code may only be used under the GPLv3 license found at
  http://www.gnu.org/licenses/gpl-3.0.txt.
*/

'use strict';

// https://github.com/jesusprubio/exploitsearch.js
const search = require('exploitsearch');

const opts = {
  timeout: 10000,
  exploits: true,
};

// With callbacks.
// search('freepbx', opts, (err, res) => {
//   if (err) {
//     console.log('Error:');
//     console.log(err);

//     process.exit(1);
//   } else {
//     console.log('Result:');
//     console.log(res);
//   }
// });

// As a promise.
search('asterisk', opts)
.then((res) => {
  console.log('Response (promise):');
  console.log(res);
})
.catch((err) => {
  console.log('Error (promise):');
  console.log(err);

  process.exit(1);
});
